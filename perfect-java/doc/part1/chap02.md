# 文字と文字列

## 文字列クラス

* 文字列は内部的には文字の配列、ただし抽象化されてるので、Javaでは文字列オブジェクトとして扱う
* StringクラスのオブジェクトはImmutable
* IndexOutOfBoundsException や StringIndexOutOfBoundsException はコードのバグなので例外を補足するのではなくコードを修正する
* new String("0123456789")は文字列リテラルで1つ、new で1つオブジェクトが生成されるのでムダ
* 文字列リテラル同士の+結合はいくら結合してもコンパイル時に最適化される
* String#concatはImmutableな性質から新しくオブジェクトを生成して返すので、ループの中で呼び出す場合は量によってはコストが高い処理になる→StringBuilderを使うこと。
* 文字列結合する場合は、文字列リテラル同士の += 演算子以外は StringBuilder#append()を使うようにしないと、大量のループで結合を行った際に処理時間に大きな違いが出る。

## 文字列比較

* == 演算子はオブジェクトの同一性を比較する。文字列の内容を比較するにはeqauls()メソッドを使う。
* 文字列リテラル同士の比較は同じ文字列リテラルは同一のオブジェクトとして最適化されるので、 == 演算子でも true が得られるが、たまたま真になると考えるべき。この動作に依存するコードは書かないようにする。
* StringBuilderの同値比較は、StringBuilder.toString().contentEquals(StringBuilder) を使う。

## 数値から文字列への変換

* String#valueOf({Type})メソッドを使う。valueOfメソッドの中で、ラッパークラスのtoStringメソッドを呼んでいるので、直接ラッパークラス#toStringメソッドを呼ぶほうが少しだけ効率的。ただし些細な差なので、気にする程でもない。
* 内部表現への変換は、toHexString(),toBinaryString()を使う。

## 文字列から数値への変換

* 利用者からの入力文字列を内部的な数値に変換するため、注意を要する。
* valueOf系メソッドとparse系メソッドは、parse系のメソッドのほうがほんの僅か効率がいいので、parse系メソッドを使う。
    * valueOfは内部的にparseIntした値に対して、-128〜127の値はキャッシュされたIntegerオブジェクトを返すが、それ以外はnew Integerして返す。
    * parseIntはintに直接変換して返す。

## 文字

* Javaプログラミングの理想は、文字列を意識して、文字を意識しないこと。
* char型の配列で文字列を扱うことはできるが、Javaの思想に反する。
* 効率性に問題がない限り、文字単位の処理は避け、文字列としての処理を意識する。
* 実行速度が問題になる場合は、文字を直接扱う。理想を追いすぎて、遅いコードを書かないようにする。
    * 文字単位で処理する場合は、クラスやメソッドに隠蔽するようにする。
* 文字列から文字の配列として取り出すときは、toCharArray()を使う。
    * toCharArrayは内部的にgetCharsメソッドを使っている。
* StringBuilderから文字の配列を取り出すときは、toCharArray()がないので、直接getCharsを使う。
* 文字の配列からStringオブジェクトを生成するには、文字の配列を引数に渡してStringオブジェクトを生成する。
    * 内部的に配列をコピーするので、元の配列を変更してもStringオブジェクトには影響しない。
* 文字の配列からStringBuilderオブジェクトを生成するには、appendメソッドに文字の配列を渡す。

## バイトと文字

* Javaの前提はバイトと文字を同一視しないこと。Java以外の世界では、バイトと文字を同一視する世界が多いため、Javaではバイトと文字を相互に変換する必要がある。
* ASCIIコードは7ビット長で英数字や記号を表現する。7ビット長なので1バイトに収まる。7ビットだと1ビットあまるので、先頭ビットを0にして8ビット長で扱う。
    * 慣習的に1バイト文字と呼ぶ
* Unicodeは16ビット長だが、最初の128文字はASCIIコードと同じ文字になっている。
    * 'a'は16進数で、0x61
    * 2進数では01100001
    * 先頭8ビットをゼロにした0000000001100001がUnicodeで文字'a'を表す。リテラル表記を使うと、u0061
* Unicodeで表現した英文字は1バイトを単純に切り落とすだけでASCIIコードになる
